<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Detalle del vehículo — Tu Empresa</title>
  <meta name="description" content="Detalle del vehículo premium importado: fotos, vídeo, especificaciones, extras, precio y contacto." />

  <!-- OpenGraph -->
  <meta property="og:type" content="product" />
  <meta property="og:title" content="Coche premium — Detalle" />
  <meta property="og:description" content="Fotos, vídeo, especificaciones y precio del coche premium seleccionado." />
  <meta property="og:image" content="https://picsum.photos/seed/coche2/1200/630" />
  <meta property="og:url" content="https://tudominio.com/car.html" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Coche premium — Detalle" />
  <meta name="twitter:description" content="Fotos, vídeo, especificaciones y precio del coche premium seleccionado." />
  <meta name="twitter:image" content="https://picsum.photos/seed/coche2/1200/630" />

  <!-- JSON-LD Product (rellenado dinámicamente con JS) -->
  <script id="car-jsonld" type="application/ld+json"></script>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- tu CSS aquí -->
</head>
<body>
  <div class="container" id="car-container">
    <h1 id="car-title">Cargando…</h1>

    <!-- Carrusel -->
    <div class="gallery" id="car-gallery" role="region" aria-label="Galería de imágenes del vehículo"></div>

    <!-- Vídeo -->
    <div id="car-video" role="region" aria-label="Vídeo del coche"></div>

    <!-- Especificaciones -->
    <div class="specs" id="car-specs" role="region" aria-label="Especificaciones técnicas"></div>

    <!-- Formulario -->
    <form id="contact-form" aria-label="Formulario de contacto">
      <h2>Solicita información</h2>
      <label for="nombre">Nombre</label>
      <input id="nombre" type="text" name="nombre" placeholder="Nombre" required>
      <label for="email">Email</label>
      <input id="email" type="email" name="email" placeholder="Email" required>
      <label for="mensaje">Mensaje</label>
      <textarea id="mensaje" name="mensaje" placeholder="Mensaje" rows="4" required></textarea>
      <input type="hidden" name="coche_interes" id="coche_interes">
      <button type="submit">Enviar</button>
      <p id="form-status" aria-live="polite"></p>
    </form>
  </div>

  <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";
    const SUPABASE_URL  = "https://swzizabjkzllxwbrcsnp.supabase.co";
    const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN3eml6YWJqa3psbHh3YnJjc25wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4MTU5MTUsImV4cCI6MjA3MTM5MTkxNX0.VDQH9t34ij9BAzV-pd0kXFUru179d1b21VNeV7VlkjA";
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON);

    const params = new URLSearchParams(location.search);
    const carId = params.get('id');

    async function loadCar() {
      const { data } = await supabase.from('cars').select('*').eq('id', carId).single();
      if (!data) return;

      const title = `${data.marca} ${data.modelo} ${data.anio}`;
      document.title = `${title} — Detalle del vehículo`;
      document.querySelector('meta[name="description"]').setAttribute('content', `Coche ${title} con ${data.km} km, ${data.combustible}, ${data.caja}, precio ${data.precio_objetivo}€.`);

      // JSON-LD dinámico
      const jsonld = {
        "@context": "https://schema.org",
        "@type": "Product",
        "name": title,
        "description": data.descripcion || "",
        "image": data.imagenes,
        "brand": data.marca,
        "model": data.modelo,
        "offers": {
          "@type": "Offer",
          "price": data.precio_objetivo || "0",
          "priceCurrency": "EUR",
          "availability": "https://schema.org/InStock"
        }
      };
      document.getElementById("car-jsonld").textContent = JSON.stringify(jsonld);
    }
    loadCar();
  </script>
</body>
</html>
